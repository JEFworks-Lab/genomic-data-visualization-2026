---
layout: post
title:  "A data visualization for sequencing spatial transcriptomics data"
author: Saadia Jameel
jhed: sjameel1
categories: [ HW1 ]
image: homework/hw1/hw1_jfan9.png
featured: false
---

### 1. What data types are you visualizing?
I am visualizing categorical data indicating whether or not the gene Nphs2 is expressed in each cell. I also use quantitative data to identify and highlight the cells with the highest expression counts for Nphs2. I use spatial data to represent the xâ€“y positions of each cell.

### 2. What data encodings (geometric primitives and visual channels) are you using to visualize these data types?
I use the geometric primitive of points to represent each cell. To encode the expression status of the Nphs2 gene I use the visual channel of colour. To encode the spatial x position and y position, I am using the visual channel of position along the x axis and y axis respectively. 

### 3. What about the data are you trying to make salient through this data visualization? 
My data visualization make more salient the relationship between Nphs2 expression and the spatial location of the cell.

### 4. What Gestalt principles or knowledge about perceptiveness of visual encodings are you using to accomplish this?
To encode the cells with the highest expression count for the gene Nphs2, I use the Gestalt principle of enclosure. By using colour as a visual encoding, I enhance the saliency of the expression status of this gene in each cell.

### 5. Code (paste your code in between the ``` symbols)

```r
file_path <- "data/Visium-IRI-ShamR_matrix.csv.gz"
data <- read.csv(file_path)

# see what the data is like
dim(data)
class(data)
data[1:5, 1:5]

# get the x and y position of the cell
position <- data[, c('x', 'y')]
rownames(position) <- data[,1] 
head(position)

# gene expression 
gene_exp <- data[,4:ncol(data)]
rownames(gene_exp) <- data[,1]
gene_exp[1:5, 1:5]

library(ggplot2)

# Make sure Nphs2 exists
nphs2 <- gene_exp[, "Nphs2"]

# Binary status for expression as I want to see, spatially, where these genes are expressed and not
nphs2_binary <- ifelse(nphs2 > 0, "Expressed", "Not expressed")

# Find top 5 cells with highest expression
top5_idx <- order(nphs2, decreasing = TRUE)[1:5]

df <- data.frame(
  x = position$x,
  y = position$y,
  nphs2 = nphs2,
  status = factor(nphs2_binary, levels = c("Not expressed", "Expressed"))
)

# Find top 5 cells with highest expression
top5_idx <- order(nphs2, decreasing = TRUE)[1:5]

# Add a column for top 5
df$top5 <- FALSE
df$top5[top5_idx] <- TRUE

# Plot
ggplot(df) +
  geom_point(aes(x = x, y = y, color = status), size = 3) +
  scale_color_manual(values = c("lightgrey", "red")) +
  
  # Circle only the top 5 cells
  geom_point(
    data = df[df$top5, ],
    aes(x = x, y = y),
    shape = 21, size = 4, stroke = 1.2, color = "blue", fill = NA
  ) +
  
  coord_fixed() +
  labs(
    title = "Spatial expression of Nphs2 with top 5 cells circled",
    color = "Nphs2 status"
  ) +
  theme_minimal() 
```

(Please do not copy. I did not do a good job on this HW.)
